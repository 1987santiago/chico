<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>Chico-UI Core - TestCases</title>
	<link rel="stylesheet" type="text/css" href="../php/css.php?q=base,forms,dropdown,layer,modal,tabNavigator,tooltip,carousel,validator">
	<link href="../libs/css/qunit.css" rel="stylesheet">
</head>
<body>

<!-- #body -->
	<h1>Chico-UI Core test-cases</h1>
    <hr />

    <div id="test"></div>
 <!-- #body -->   
	<h1 id="qunit-header">QUnit Test Suite</h1>
	<h2 id="qunit-banner"></h2>
	<div id="qunit-testrunner-toolbar"></div>
	<h2 id="qunit-userAgent"></h2>
	<ol id="qunit-tests"></ol>
	<div id="qunit-fixture">test markup</div>

	<script src="../libs/js/jquery.js"></script>
	<script src="../libs/js/qunit.js"></script>
	<script src="../php/chico.php?get=modal&debug=true"></script>
	<script src="functions.js"></script>

<!-- #script -->
	<script>
			
		$.fx.off = true;

		/**
		 * 	Test Cases
		 */
		
    	module("Chico ui.get");
    	
        asyncTest("Get dojo library from google CDN using ui.get(component)", function() {
            
            ui.get({            
                method: "component",
                component: "dojo",
                script: "http://ajax.googleapis.com/ajax/libs/dojo/1.5/dojo/dojo.xd.js",
                callback: function(){
                    ok(dojo,"Expected to find Dojo in the DOM. Get's Callbacks working fine baby ;)");
                    start();
                }
            });
    
        });

      	module("Chico factory");
 
        test("Post-configure chat component through Factory", function(){            
    		// Chat
    		ui.factory({
    		      component: "chat",
    		      callback: createChat
    	      });
    	      
    	    stop();  
    	    
            function createChat() {
                $('.chat').chat({
                    ruleGroupName: 'APP_PENDING_PAYMENTS',
                    style: 'block',
                    template: '3'
                });

                start();
                ok( ui["chat"] , "Expected to find chat instantiation");

            } 

            ok( ui.instances["chat"] , "Expected to find chat in the instances map");
            
        });

    	module("Chico Core");

    	test("Basic information",function(){
    	   
    	   expect ( 3 );
    	   
       	   ok(ui.version, "Expected to find a Version defined");

    	   ok(ui.internals, "Expected to find Internals components to load");
    	   
    	   ok(ui.components, "Expected to find Visual components to load");

    	});
    	
    	test("Check for critical internals components",function(){

            expect ( 2 );

           ok(ui.factory, "Expected to find a Factory module");
           
           ok(ui.get, "Expected to find a Get (Communicator) module");
               	       	   
    	});
   
       	module("Chico components and internals");
       	
       	test("Check for internal components instantiation",function(){
       	    
       	    expect ( ui.internals.split(",").length );
       	    
       	    $(ui.internals.split(",")).each(function(i,e){
       	        ok( ui[e] , "Expected to find "+e+" instantiation");
       	    });
       	    
        });

       	test("Check for visual components instantiation",function(){

            expect ( ui.components.split(",").length );
       	    
       	    $(ui.components.split(",")).each(function(i,e){
       	        ok( ui[e] , "Expected to find "+e+" instantiation");
       	    });
       	    
        });
        
    	test("Check for visual components in the instances map",function(){
       	    
       	    expect ( ui.components.split(",").length );
       	    
       	    $(ui.components.split(",")).each(function(i,e){
       	        ok( ui.instances[e] , "Expected to find "+e+" in the instances map");
       	    });
       	    
        });

        test("Basic component returns",function(){
           
           expect ( 1 );
           
            var test_modal = $("#test").modal({
        		content: {
    				type:'param',
    				data:'<h2>Test Modal</h2><p>Usamos esta ventana modal para probar que la definici√≥n de un componente devuelve la instancia creada del mismo.</p>'
    			}
        	});
        	        	
          	ok(typeof test_modal == "object", "Expected to find a Object in a component return");
 
        });
                 		
	</script>

</body>
</html>
