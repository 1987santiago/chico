<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>Modal - TestCases</title>
	<link rel="stylesheet" type="text/css" href="../php/packer.php?type=css&get=modal">
	<link href="../libs/css/qunit.css" rel="stylesheet">
</head>
<body>

    <!-- #body -->
	<h1>Chico-UI: Modal testcases</h1>
		<h2>Contenido por parametro</h2>
		<div class="box">
			<form action="../test.html" method="post">
				<input type="submit" class="btn primary" id="testModal" value="Comprar">				
			</form>
		</div>
		<h2>Contenido por DOM</h2>
		<div class="box">
			<form action="../test.html" method="post">
				<input type="submit" class="btn primary" id="testModalDOM" value="Comprar">				
			</form>
		</div>

		<h2>Contenido por AJAX</h2>
		<div class="box">
			<form action="../test.html" method="post">
				<input type="submit" class="btn primary" id="testModalAjax" value="Comprar">				
			</form>
		</div>
		
		
		<h1>Chico-UI: Transition testcases</h1>
		<h2>Contenido por parametro</h2>
		<div class="box">
			<form action="../test.html" method="post">
				<input type="submit" class="btn primary" id="testTransition" value="Comprar">				
			</form>
		</div>
		<h2>Contenido por DOM</h2>
		<div class="box">
			<form action="../test.html" method="post">
				<input type="submit" class="btn primary" id="testTransition2" value="Comprar">				
			</form>
		</div>
	<br>
	
	<div id="testDOM" style="display:none">
		<h2>Modal title DOM</h2>
		<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec sit amet purus in sapien luctus sodales. Curabitur dui velit, cursus in sagittis aliquam, dictum at neque. Ut gravida scelerisque lorem non pulvinar. Pellentesque et urna vitae nisl porta imperdiet sed nec ipsum. Sed non sem velit. Cras id consectetur tellus. Vestibulum posuere purus non enim pharetra vel vulputate eros hendrerit. Ut pulvinar placerat risus quis interdum. Mauris eget tempus risus. Aenean accumsan dolor in lorem elementum ac tincidunt urna rutrum. Sed sit amet nunc velit, vitae tincidunt ipsum. Fusce mattis elementum justo, et lacinia odio pharetra a. Donec egestas imperdiet eros a interdum. Suspendisse sodales, ligula vitae pulvinar aliquam, elit justo pretium urna, ut hendrerit arcu dolor vitae ipsum.</p>
	</div>
<!-- #body -->	
	<hr>
	<h1 id="qunit-header">QUnit Test Suite</h1>
	<h2 id="qunit-banner"></h2>
	<div id="qunit-testrunner-toolbar"></div>
	<h2 id="qunit-userAgent"></h2>
	<ol id="qunit-tests"></ol>
	<div id="qunit-fixture">test markup</div>

	<script src="../libs/js/jquery.js"></script>
	<script src="../libs/js/qunit.js"></script>
	<script src="../php/packer.php?get=modal&debug=true"></script>
	<script src="functions.js"></script>
	
<!-- #script -->
	<script>

		var testModal = $('#testModal').modal({
    		content: '<h2>Modal title</h2><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec sit amet purus in sapien luctus sodales. Curabitur dui velit, cursus in sagittis aliquam, dictum at neque. Ut gravida scelerisque lorem non pulvinar. Pellentesque et urna vitae nisl porta imperdiet sed nec ipsum. Sed non sem velit. Cras id consectetur tellus. Vestibulum posuere purus non enim pharetra vel vulputate eros hendrerit. Ut pulvinar placerat risus quis interdum. Mauris eget tempus risus. Aenean accumsan dolor in lorem elementum ac tincidunt urna rutrum. Sed sit amet nunc velit, vitae tincidunt ipsum. Fusce mattis elementum justo, et lacinia odio pharetra a. Donec egestas imperdiet eros a interdum. Suspendisse sodales, ligula vitae pulvinar aliquam, elit justo pretium urna, ut hendrerit arcu dolor vitae ipsum.</p>'
    	});
    
	    var testModalDOM = $('#testModalDOM').modal({
	    	content: '#testDOM'
	    });	    
	    
		var testTransition = $('#testTransition').transition();
		
		var testTransition2 = $('#testTransition2').transition("Espere a que valide el test por favor...");

	    var testModalAjax;					
		$.fx.off = true;
		
		/**
		 * 	Test Cases
		 */

        module("Modal basics instance object");

        test("Modal chain methods", function(){
            
            expect ( 3 );
            
            var testModalOriginal = testModal;
            
            var chainShow = testModal.show();
            
            var chainHide = testModal.hide();

            var chained = testModal.show().hide();
             
            ok ( chainShow === testModalOriginal, "Expected to return original instance object on show() method call");
            
            ok ( chainHide === testModalOriginal, "Expected to return original instance object on hide() method call");

            ok ( chained === testModalOriginal, "Expected to return original instance object on .show().hide() methods chained call");
            
        });
    

		module('Modal layout and interaction');
						
		test('Opens basic modal dialog', function(){
		  
			notExists('.ch-dimmer');
			notExists('.ch-modal');
			
			$('#testModal').click();
			
			exists('.ch-dimmer');
			exists('.ch-modal');
			
			isVisible('.ch-dimmer');
			isVisible('.ch-modal');
			
		});			
		
		test("Close modal dialog", function() {

			$('.ch-dimmer').click();		  

			notExists('.ch-dimmer');
			notExists('.ch-modal');
			
		});

		test('Close modal dialog with close button', function(){
		  					
			$('#testModal').click();
			
			exists('.ch-modal .ch-close');
			
			$('.ch-close').trigger('click');
			
			notExists('.ch-dimmer');
			notExists('.ch-modal');
			
		});

		module('Modal content configurations');

		test('STATIC content', function() {

			$('#testModal').click();
			
			ok( testModal.content , "Expected to find a defined content on the modal instance");
			
			hasContent('.ch-modal', 'Lorem');
			
			$('.ch-dimmer').trigger('click');

		});
				
		test('DOM content', function(){
			
			$("#testModalDOM").click();

			ok( testModal.content , "Expected to find a defined content on the modal instance");
			
			hasContent(".ch-modal", "Modal title DOM");

			$('.ch-dimmer').trigger('click');
			
		});

				
		test('AJAX content', function(){
        
            testModalAjax = $('#testModalAjax').modal({
                ajax: true,
				onContentLoad: function(){ 
                        
                        start();
                        
                        hasContent(".ch-modal-content h2", "Titulo de contenido ajax");

                        $('.ch-dimmer').trigger('click');
                        
                }
            });

			$("#testModalAjax").click();

			ok( testModalAjax.content , "Expected to find a defined content on the modal instance");

			stop();
		});
        
        test("Basics for testModal", function(){

            expect( 3 );

       		ok( testModal.uid >= 0 , "Expected to find a defined content on the modal instance");
       		
    		ok( testModal.type == "modal" , "Expected to find \"modal\" as value of type attribute");
    		
    		ok( testModal.content != undefined, "Expected to find a defined content on the modal instance");

        });

        test("Basics for testModalDOM", function(){

            expect( 4 );

       		ok( testModalDOM.uid >= 0 , "Expected to find a number bigger than 0 on uid propertie");
       		
    		ok( testModalDOM.type == "modal" , "Expected to find \"modal\" as value of type attribute");
    		
    		ok( testModalDOM.content != undefined , "Expected to find a defined content on the modal instance");

    		ok( /\.|\#/.test(testModalDOM.content) , "Expected to find a CSS \"#id\" or \".class\" declaration on content attribute");

        });

        test("Basics for testModalAjax", function(){

            expect( 3 );

       		ok( testModalAjax.uid >= 0 , "Expected to find a defined content on the modal instance");
       		
    		ok( testModalAjax.type == "modal" , "Expected to find \"modal\" as value of type attribute");
    		
    		ok( testModalAjax.content != undefined , "Expected to find a defined content on the modal instance");

        });
        
        
        
        
        /* TRANSITION TESTS */ 
                
        module("Transition basics instance object");
		
		test("Basics for transitions window", function(){

            expect( 3 );

       		ok( testTransition.uid >= 0 , "Expected to find a defined content on the transition instance");
       		
    		ok( testTransition.type == "transition" , "Expected to find \"transition\" as value of type attribute");
    		
    		ok( testTransition.content != undefined , "Expected to find a defined content on the transition instance");

        });
		
		test("Transition chain methods", function(){
            
            expect ( 3 );
            
            var testTransitionOriginal = testTransition;
            
            var chainShow = testTransition.show();
            
            var chainHide = testTransition.hide();

            var chained = testTransition.show().hide();
             
            ok ( chainShow === testTransitionOriginal, "Expected to return original instance object on show() method call");
            
            ok ( chainHide === testTransitionOriginal, "Expected to return original instance object on hide() method call");

            ok ( chained === testTransitionOriginal, "Expected to return original instance object on .show().hide() methods chained call");
            
        });
        
        
        module('Transition layout and interaction');
						
		test('Opens basic transition window', function(){
		  
			notExists('.ch-dimmer');
			notExists('.ch-transition');
			
			$('#testTransition').click();
			
			exists('.ch-dimmer');
			exists('.ch-transition');
			
			isVisible('.ch-dimmer');
			isVisible('.ch-transition');
			
			testTransition.hide();
			
		});
		
		test('Transition window without close button and dimmer close action', function(){
		  					
			$('#testTransition').click();
			
			notExists('.ch-modal .ch-close');
			
			$('.ch-dimmer').trigger('click');
			
			exists('.ch-dimmer');
			exists('.ch-transition');
			
			testTransition.hide();
			
		});
		
		module("Transition custom messages");
		
		test("Custom massages for transitions window", function(){

            expect( 1 );

			var msg = "<div class=\"loading\"></div><p>Espere a que valide el test por favor...</p>";

       		ok( testTransition2.content ==  msg, "Expected to find a custom message on the transition content");

        });
        	
	</script>

</body>
</html>

